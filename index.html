<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Passport Validity Checker</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    padding: 40px;
}

.container {
    background: #ffffff;
    padding: 25px;
    max-width: 500px;
    margin: auto;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

label {
    display: block;
    margin-top: 12px;
    font-weight: bold;
}

input, button {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
}

button {
    margin-top: 15px;
    cursor: pointer;
}

.hidden {
    display: none;
}

.result {
    margin-top: 15px;
    padding: 10px;
    font-weight: bold;
    text-align: center;
    border-radius: 5px;
}

.valid {
    background: #d4edda;
    color: #155724;
}

.invalid {
    background: #f8d7da;
    color: #721c24;
}

.operator-tag {
    background: #eef2ff;
    padding: 8px;
    margin-bottom: 10px;
    border-radius: 5px;
    font-weight: bold;
}
</style>
</head>

<body>

<div class="container">
    <h2>Passport Validity Checker</h2>

    <!-- Operator Input -->
    <label>Operator Name</label>
    <input type="text" id="operatorName" placeholder="Enter your name">
    <button id="startBtn">Continue</button>

    <!-- Passport Form -->
    <div id="formSection" class="hidden">

        <div class="operator-tag">
            Operator: <span id="operatorDisplay"></span>
        </div>

        <label>First Name</label>
        <input type="text" id="firstName">

        <label>Last Name</label>
        <input type="text" id="lastName">

        <label>Passport Number</label>
        <input type="text" id="passportNo">

        <label>Travel Date</label>
        <input type="date" id="travelDate">

        <label>Passport Expiry Date</label>
        <input type="date" id="expiryDate">

        <button id="checkBtn">Check & Save</button>

        <div id="result" class="result"></div>
    </div>
</div>

<script>
// ‚úÖ Your Apps Script URL
const SCRIPT_URL =
"https://script.google.com/macros/s/AKfycby8upXPLdKsp9gah6RDMN2q5BpljWTZfTdYnUkvw6xSnUNuMSDsydydsIO37c5lGUg/exec";

let operator = "";

// Auto-set travel date to today
document.getElementById("travelDate").value =
    new Date().toISOString().split("T")[0];

// STEP 1: Operator Continue
document.getElementById("startBtn").addEventListener("click", () => {
    const name = document.getElementById("operatorName").value.trim();

    if (!name) {
        alert("Please enter operator name");
        return;
    }

    operator = name;
    document.getElementById("operatorDisplay").textContent = operator;

    document.getElementById("operatorName").style.display = "none";
    document.getElementById("startBtn").style.display = "none";
    document.getElementById("formSection").classList.remove("hidden");
});

// STEP 2: Check validity & save
document.getElementById("checkBtn").addEventListener("click", () => {

    const travelDateVal = document.getElementById("travelDate").value;
    const expiryDateVal = document.getElementById("expiryDate").value;
    const result = document.getElementById("result");

    if (!expiryDateVal) {
        result.textContent = "Please enter passport expiry date";
        result.className = "result invalid";
        return;
    }

    const travelDateObj = new Date(travelDateVal);
    const expiryDateObj = new Date(expiryDateVal);

    const requiredDate = new Date(travelDateObj);
    requiredDate.setMonth(requiredDate.getMonth() + 6);

    const validity =
        expiryDateObj >= requiredDate ? "VALID" : "INVALID";

    result.textContent =
        validity === "VALID"
            ? "Passport is VALID ‚úÖ (Data saved)"
            : "Passport is NOT valid ‚ùå (Data saved)";

    result.className =
        validity === "VALID" ? "result valid" : "result invalid";

    // üî• SEND DATA USING FORMDATA
    const formData = new FormData();
    formData.append("operator", operator);
    formData.append("firstName", firstName.value);
    formData.append("lastName", lastName.value);
    formData.append("passportNumber", passportNo.value);
    formData.append("travelDate", travelDateVal);
    formData.append("expiryDate", expiryDateVal);
    formData.append("validity", validity);
    formData.append("timestamp", new Date().toISOString());

    fetch(SCRIPT_URL, {
        method: "POST",
        mode: "no-cors",
        body: formData
    });
});
</script>

</body>
</html>
