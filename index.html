<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Passport Validity Checker</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  padding: 40px;
}

.container {
  background: #fff;
  padding: 25px;
  max-width: 500px;
  margin: auto;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

h2 {
  text-align: center;
}

label {
  display: block;
  margin-top: 15px;
  font-weight: bold;
}

input {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
}

button {
  margin-top: 20px;
  width: 100%;
  padding: 10px;
  font-size: 16px;
  cursor: pointer;
}

.hidden {
  display: none;
}

.result {
  margin-top: 20px;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  border-radius: 5px;
}

.valid {
  background: #d4edda;
  color: #155724;
}

.invalid {
  background: #f8d7da;
  color: #721c24;
}
</style>
</head>

<body>

<div class="container">
  <h2>Passport Validity Checker</h2>

  <!-- STEP 1 -->
  <div id="operatorSection">
    <label>Operator Name</label>
    <input type="text" id="operatorName" placeholder="Enter your name">
    <button onclick="startForm()">Continue</button>
  </div>

  <!-- STEP 2 -->
  <div id="formSection" class="hidden">
    <label>First Name</label>
    <input type="text" id="firstName">

    <label>Last Name</label>
    <input type="text" id="lastName">

    <label>Passport Number</label>
    <input type="text" id="passportNo">

    <label>Travel Date</label>
    <input type="date" id="travelDate">

    <label>Passport Expiry Date</label>
    <input type="date" id="expiryDate">

    <button onclick="checkAndSave()">Check & Save</button>

    <div id="result" class="result"></div>
  </div>
</div>

<script>
const SCRIPT_URL =
  "https://script.google.com/macros/s/AKfycbzhTPgCRy299l2euNFRZZ5ObIBAfgJbGiRLoq1c2waJwQ7x96RVwFD-lizipDnq2THN/exec";

// Auto set travel date
document.getElementById("travelDate").value =
  new Date().toISOString().split("T")[0];

function startForm() {
  const operator = document.getElementById("operatorName").value.trim();
  if (!operator) {
    alert("Please enter Operator Name");
    return;
  }
  document.getElementById("operatorSection").classList.add("hidden");
  document.getElementById("formSection").classList.remove("hidden");
}

function checkAndSave() {
  const operator = document.getElementById("operatorName").value.trim();
  const firstName = document.getElementById("firstName").value.trim();
  const lastName = document.getElementById("lastName").value.trim();
  const passportNo = document.getElementById("passportNo").value.trim();
  const travelDate = document.getElementById("travelDate").value;
  const expiryDate = document.getElementById("expiryDate").value;
  const resultDiv = document.getElementById("result");

  if (!firstName || !lastName || !passportNo || !travelDate || !expiryDate) {
    alert("Please fill all fields");
    return;
  }

  const travel = new Date(travelDate);
  const expiry = new Date(expiryDate);
  const required = new Date(travel);
  required.setMonth(required.getMonth() + 6);

  let validity = "";

  if (expiry >= required) {
    validity = "VALID";
    resultDiv.textContent = "Passport is VALID ✅";
    resultDiv.className = "result valid";
  } else {
    validity = "INVALID";
    resultDiv.textContent = "Passport is NOT valid ❌ (Less than 6 months)";
    resultDiv.className = "result invalid";
  }

  // SEND DATA TO GOOGLE SHEET (FormData)
  const formData = new FormData();
  formData.append("operator", operator);
  formData.append("firstName", firstName);
  formData.append("lastName", lastName);
  formData.append("passportNumber", passportNo);
  formData.append("travelDate", travelDate);
  formData.append("expiryDate", expiryDate);
  formData.append("validity", validity);

  fetch(SCRIPT_URL, {
    method: "POST",
    body: formData
  })
  .then(() => {
    console.log("Saved successfully");
  })
  .catch(() => {
    console.log("Save failed");
  });

  // Clear form (keep operator)
  document.getElementById("firstName").value = "";
  document.getElementById("lastName").value = "";
  document.getElementById("passportNo").value = "";
  document.getElementById("expiryDate").value = "";
}
</script>

</body>
</html>
